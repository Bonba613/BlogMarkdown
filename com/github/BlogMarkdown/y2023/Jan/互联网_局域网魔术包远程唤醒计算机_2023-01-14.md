# 互联网、局域网魔术包远程唤醒计算机_2023-01-14



[TOC]



## 下载所需软件

Wake On Lanv



**互联网远程开机软件**

> 如果你已经设置好远程开机了，你想使用其他终端进行远程开机，安卓的可以使用“Wake On Lan for Android”、“Wake On Lan”、“Fing（集成扫描功能）”，IPhone或IPad的可以使用“WOL Control”，PC端的还有“NetWaker（含通过IP获取MAC功能）”。
>
> > PHP远程开机
> >
> > http://www.huangguofeng.com/gongju.php?id=2



## 教程

> ### 一、主板BIOS设置
>
> 1. 开机按住 F2 或者 DEL 进入bios，这是针对华硕主板，其它主板可以自行百度。
> 2. 进入”高级电源管理设置（APM）“
> 3. 将 PCI-E设备唤醒 设置为启用：Enabled
> 4. 按F10保存
>
> ### 二、进入Windows，设置网卡
>
> 1. win + r 唤起运行，输入：devmgmt.msc    ，打开设备管理器
> 2. 找到有线网络的网卡，右键属性进入高级设置，找到唤醒魔包，将其启用
> 3. 有线网络的网卡，右键属性进入高级设置，网络唤醒，选择Enabled
> 4. 如果是Intel网卡，注意：右键-属性-电源管理-链接唤醒必须打勾
> 5. Intel网卡，右键-属性-电源管理，关闭”允许计算机关闭此设备以节约电源“
> 6. 控制面板-硬件和声音-电源选项-选择电源按钮的功能-关机设置-取消勾选”启用快速启动“
>
> ------
>
> <!--到这里可以使用局域网 Wake On Lan 软件测试了-->
>
> <!--因为在局域网内，发送包含目标计算机的MAC地址的魔术包即可实现局域网内开机。不需要设置IP与MAC地址绑定-->
>
> <!--如果局域网内可以开机，则继续往下看-->
>
> 
>
> ### 三、路由器设置
>
> 1. 以tp-link的路由器为例
>
> 2. 进入”IP与MAC绑定“，将IP与目标计算机的MAC地址绑定
>
> 3. 进入”DDNS“。如果没有域名，就创建一个TP-LINK的免费域名地址。在路由器登录域名
>
> 4. 进入”虚拟服务器“，点击”添加“，填写目标计算机的IP地址。协议选择UDP。外部端口和内部端口可以填写1024~65535以内的端口号。注意要避免使用一些企业或组织正在使用的端口号，如：3389,8080
>
>    <!--外部端口号与互联网开机有关，只需牢记外部端口号即可。内部端口号随便设置不影响。一般内部端口号设置与外部端口号一样的值-->
>
> 
>
> > Windows设置远程唤醒WOL+远程连接
> >
> > https://blog.csdn.net/dazhisir/article/details/124871469
>
> > WIN10远程唤醒开机+双层路由端口映射设置详细教程
> >
> > https://post.smzdm.com/p/546713/



## 发送魔术包



**用于互联网远程唤醒的网址或应用**

> IPhone-WOL_Control（可用）



> Wake On Lan over the Internet（不可用）
>
> https://www.depicus.com/wake-on-lan/woli

> PHP远程开机（不可用）
>
> http://www.huangguofeng.com/gongju.php?id=2

> 微信小程序__网络唤醒Wake On Lan（不可用）



**以下使用”IPhone-WOL_Control“为例，对发送魔术包进行讲解**

host name/IP

<!--输入域名或公网IP地址-->

Port

<!--输入在路由器设置好的外部端口号-->

MAC address

<!--输入需要远程的计算机的MAC地址（物理地址）-->

Password	<!--留空，不用管-->



然后点击 ”Send WOL“。如果设置无误的话，计算机一秒都不到就会被唤醒了。

点击 ”MAC List“ 可以保存配置信息。保存好配置信息后，下次使用可以直接一键启动。



## 参考

### 在互联网远程开机的简单介绍

> 发送魔术包进行远程开机。使用魔术包进行远程开机无需额外购买开机棒等即可实现远程开机；
>
> 基本原理：使用目的计算机的MAC地址构建魔术包，再创建Socket，发送基于UDP协议的广播包到指定的域名或IP上。局域网通过子网掩码计算广播地址。外网直接使用公网IP（子网掩码为255.255.255.255）。
>
> 备注：此方法实现开机的需要满足以下条件：
>
> 第一，主板和网卡必须支持WOL（Wake On Lan），据说“一般2002年以后的主板都支持此功能”；
>
> 第二，需要对网卡和BIOS进行相应设置；
>
> 第三，需要对路由器进行相应设置。
>
> > PHP远程开机
> >
> > http://www.huangguofeng.com/gongju.php?id=2



### 常用端口及端口范围

> **端口范围**
>
> 一般用到的是1到65535,其中0不使用。
> 1-1023为知名端口（Well-Known Ports）。
> 1024-49151为用户端口（Registered ports）。
> 49152-65535称为动态端口（Dynamic Ports）。
> 知名端口即众所周知的端口号，范围从0到1023，这些端口号一般固定分配给一些服务。
> 用户端口由IANA负责分配，需要走申请流程，申请手续相对系统端口来说不那么严格。
> 动态端口的范围从49152到65535，这些端口号一般不固定分配给某个服务，也就是说许多服务都可以使用这些端口。
> ————————————————
>
> **常用端口记录**
>
> 21端口：FTP 文件传输服务
> 22端口：SSH 远程连接服务
> 23端口：TELNET 终端仿真服务
> 25端口：SMTP 简单邮件传输服务
> 53端口：DNS 域名解析服务
> 80端口：HTTP 超文本传输服务
> 443端口：HTTPS 加密的超文本传输服务
> 3306端口：MYSQL数据库端口
> 3389端口：WIN2003远程登陆
> 8080端口：TCP服务端
> 8888端口：Nginx服务器
> UDP67，UDP68：DHCP服务
> ————————————————
>
> > 常用端口及端口范围
> >
> > https://blog.csdn.net/qq_43236906/article/details/109249050



### Wake On Lan未成功的一些实例

> （在我想使用）Wake On Lan（后文皆用 WOL 代替）这项技术远程开机时，总是失败，在查阅各种资料后成功使用上了 WOL，下面总结几点导致失败的原因。
>
> 1. 发送 Magic Packet（魔法数据包），不多阐述，如果是编程发包，请使用UDP封包。
> 2. 在 BIOS 中开启 WOL，在我的实验设备的 BIOS 中，它的全名为“Wake On Lan In S5”。
> 3. 系统层面。Win7 没有官方支持 WOL，但是依托于网卡的 WOL，可以成功唤醒。Win8 及以上的系统（我本人 Win10）有很大的区别点，就在于快速启动这个功能。快速启动将计算机置于 S4 状态中（正常关机是 S5）[1]，而 WOL 仅在 S5 提供支持，所以需要关闭“快速启动”[2]。这一点在不同的计算机上可能有区别，我的硬件仅支持 WOL On S5，据我了解 Mac 仅支持 WOL On S0(S3)。
>    ————————————————
>    版权声明：本文为CSDN博主「Bpazy」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
>    原文链接：https://blog.csdn.net/hanziyuan08/article/details/97325883
> 4. 在正常开机状态下，关闭计算机，网卡仍保持着连接。如果这时候断开电源再恢复供电，则网卡不会重新建立连接，也就不能远程唤醒。所以请保持住关机状态下的供电。
> 5. 无线网卡不支持远程唤醒，请使用有线网卡。
>
> 以上几点都是基于我的几台设备总结的，不排除有误，其中 3、4、5 三点浪费了我极久的时间调查。
>
> ————————————————
>
> 参考来源
>
> [1] ACPI电源管理介绍：https://www.cnblogs.com/AlwaysOnLines/p/4548097.html
> [2] 系统层面的微软解答：https://answers.microsoft.com/en-us/windows/forum/windows_10-power/windows-10-wake-on-lan-not-working-from-shutdown/ba6ae540-b602-42f3-b5bb-afe95fe6661c
>
> ------
>
> > 总结几点 Wake On Lan (WOL) 失败的原因
> >
> > https://blog.csdn.net/hanziyuan08/article/details/97325883





> 1. 注意关机（不要拔电源插头）时网线接主板处灯亮的，如果灯不亮，证明主板的没有打开（Wake On LAN）。还有就是我主板上LAN功能是本身打开了的，但是灯是不亮的，后来打开LAN PXE 才是亮的，估计新主板跟以前的设置又不同的。
> 2. 友情提醒下的，可以远程启动以后，==千万不要拔电源，如果拔了电源，地址就会失效，必须重新手动启动一下，正常关机，才可以（远程）启动了==，技术给我的建议就是配个UPS电源，保证不断电。
>    <!--实际状况因主板而异-->
> 3. 主板会将[断电後网络唤醒的功能]存储在NVRAM模块中，存储完毕自动断电。 
>    网络唤醒功能存储在主板的NVRAM中，220V断掉后，主板也同时断电，NVRAM被清空，所以无法进行唤醒。
>    只有在接上220V后上电一会，才会重新加载数据到NVRAM，才可以实现断电后网络唤醒的功能。
> 4. <!--技嘉主板自带的截图功能-->
>    怎么没有人问我BIOS截图杂这么清晰的啊，哈哈，其实现在主板都支持BIOS直接截图U盘的，我的技嘉主板是按F12，当然U盘必须是FAT32格式的，截图成功会有提示哦。
> 5. 如果是Intel网卡，注意：右键-属性-电源管理-链接唤醒必须打勾
>    （这个必须要说下，链接唤醒是真最新，挡住的，你必须落下来才可以看见，我当初就是没有看见，怎么搞局域网都唤醒不了，坑死了）
>
> > WIN10远程唤醒开机+双层路由端口映射设置详细教程
> >
> > https://post.smzdm.com/p/546713/



### 关于seafile私有云盘

> 使用seafile搞了一个私有云盘
>
> <!--是私人搭建的网络云盘（类似百度云盘、GoogleDrive），不是家用NAS本地服务器-->
>
> > 公网远程开机（唤醒家庭PC）
> >
> > https://blog.csdn.net/kingredfly/article/details/115274207

> Seafile 云服务 -- 免部署运维，在云上使用 Seafile
>
> https://www.seafile.com/home/

> 拜拜百度云！自建开源网盘 Seafile专业版 全攻略指南
>
> https://zhuanlan.zhihu.com/p/136892658
